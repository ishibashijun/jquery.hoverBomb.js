/**
 * Name: jquery.hoverBomb.js
 * Description: Explode text on hover
 * Copyright (c) 2015 Jun Ishibashi
 * Version: 0.0.6
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */
(function(e){e.fn.hoverBomb=function(c){var d={direction:"all",diameter:100,shakeStep:1,shakeRotate:45,shakeLimit:10,growSpeed:100,explosionMomentum:50,afterEffect:"fade",afterAnimationTime:500},g=function(a){this.elem=a;this.config=e.extend({},d,c);this.radius=.5*this.config.diameter;this.shakeRadius=0;this.explodeLoop=this.growLoop=this.loop=null;this.exploded=!1;this.longest=0;this.fps=1E3/30};g.prototype={explode:function(){var a=this;this.exploded=!0;this.longest=this.shakeRadius=0;clearInterval(this.loop);
clearInterval(this.growLoop);this.explodeLoop=setInterval(function(){a.explodeFunc()},this.fps)},explodeFunc:function(){var a=this,b=this.config,c=this.elem.children("span"),l=Array(c.length),d,k,g,h=0;c.each(function(b,c){l[b]={x:f(-a.radius,a.radius,!0),y:f(-a.radius,a.radius,!0)};d=l[b].x-parseInt(e(c).css("left"));k=l[b].y-parseInt(e(c).css("top"));g=d*d+k*k;h<g&&(a.longest=b,h=g)});c.each(function(c,d){var g=parseInt(e(d).css("top")),m=parseInt(e(d).css("left")),f=l[c].x-m,k=l[c].y-g,h=Math.atan2(k,
f),n=Math.cos(h)*b.explosionMomentum,h=Math.sin(h)*b.explosionMomentum,f=f/l[c].x,k=k/l[c].y,m=m+n*f,g=g+h*k;e(d).css({top:g,left:m});if(c===a.longest&&(1<=f||1<=k))return clearInterval(a.explodeLoop),"animate"===b.afterEffect?setTimeout(function(){a.animationEffect()},b.afterAnimationTime):"fade"===b.afterEffect&&a.fadeEffect(),!1})},animationEffect:function(){var a=this;this.elem.children("span").each(function(b,c){b!==a.longest?e(c).animate({top:0,left:0},a.config.callbackAnimationSpeed):a.elem.children("span").eq(a.longest).animate({top:0,
left:0},a.config.callbackAnimationSpeed,function(){a.elem.children("span").each(function(a,b){e(b).css({"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)","-o-transform":"rotate(0deg)",transform:"rotate(0deg)"})});a.exploded=!1})})},fadeEffect:function(){var a=this,b=this.elem.children("span"),c=b.length-1,d=b.eq(c);b.each(function(a,b){if(a!==c)e(b).fadeOut(500);else return!1});d.fadeOut(500,function(){b.each(function(a,b){if(a===c)return!1;h(e(b));
e(b).show(500)});h(d);d.show(500,function(){a.exploded=!1})})},preExplode:function(){var a=this,b=this.config;this.loop=setInterval(function(){a.elem.children("span").each(function(c,d){e(d).css({top:f(-a.shakeRadius,a.shakeRadius,!0),left:f(-a.shakeRadius,a.shakeRadius,!0),"-webkit-transform":"rotate("+f(-b.shakeRotate,b.shakeRotate,!0)+"deg)","-moz-transform":"rotate("+f(-b.shakeRotate,b.shakeRotate,!0)+"deg)","-ms-transform":"rotate("+f(-b.shakeRotate,b.shakeRotate,!0)+"deg)","-o-transform":"rotate("+
f(-b.shakeRotate,b.shakeRotate,!0)+"deg)",transform:"rotate("+f(-b.shakeRotate,b.shakeRotate,!0)+"deg)"})})},this.fps);this.growLoop=setInterval(function(){a.shakeRadius+=b.shakeStep;a.shakeRadius>b.shakeLimit&&a.explode()},b.growSpeed)},cancelExplode:function(){this.exploded||(clearInterval(this.loop),clearInterval(this.growLoop),this.shakeRadius=0,this.elem.children("span").each(function(a,b){h(e(b))}))}};return this.each(function(){var a=e(this),b=p(a.text()),c=new g(a);a.html(b);a.on("mouseenter",
function(){c.preExplode()});a.on("mouseleave",function(){c.cancelExplode()})})};var p=function(c){for(var d=0,e=c.length,a="";d<e;d++)a+="<span style='position: relative;'>"+(" "==c[d]?"&nbsp;":c[d])+"</span>";return a},f=function(c,d,e){return c?d?e?Math.random()*(d-c)+c:Math.round(Math.random()*(d-c)+c):Math.round(Math.random()*c):Math.random()},h=function(c){c.css({top:0,left:0,"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)","-o-transform":"rotate(0deg)",
transform:"rotate(0deg)"})}})(jQuery);
