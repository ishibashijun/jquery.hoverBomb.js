/**
 * Name: jquery.hoverBomb.js
 * Description: Explode text on hover
 * Copyright (c) 2015 Jun Ishibashi
 * Version: 0.0.8
 * Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
 */ 
(function(e,p){e.fn.hoverBomb=function(c){var f={direction:"all",diameter:100,shakeStep:1,shakeRotate:45,shakeLimit:10,growSpeed:100,explosionMomentum:50,afterEffect:"fade",afterAnimationTime:500},k=function(a){this.elem=a;this.config=e.extend({},f,c);this.radius=.5*this.config.diameter;this.shakeRadius=0;this.explodeLoop=this.growLoop=this.loop=null;this.exploded=!1;this.longest=0;this.fps=1E3/30};k.prototype={explode:function(){var a=this;this.exploded=!0;this.longest=this.shakeRadius=0;clearInterval(this.loop);
clearInterval(this.growLoop);this.explodeLoop=setInterval(function(){a.explodeFunc()},this.fps)},explodeFunc:function(){var a=this,b=this.config,c=this.elem.children("span"),n=Array(c.length),g,h,f,k,l,p=0;c.each(function(c,m){"all"===b.direction?(g=d(-a.radius,a.radius,!0),h=d(-a.radius,a.radius,!0)):"north"===b.direction?(g=d(.5*-a.radius,.5*a.radius),h=d(-a.radius,0,!0)):"south"===b.direction?(g=d(.5*-a.radius,.5*a.radius),h=d(0,a.radius,!0)):"east"===b.direction?(g=d(0,a.radius,!0),h=d(.5*-a.radius,
.5*a.radius,!0)):"west"===b.direction&&(g=d(-a.radius,0,!0),h=d(.5*-a.radius,.5*a.radius,!0));n[c]={x:g,y:h};f=n[c].x-parseInt(e(m).css("left"));k=n[c].y-parseInt(e(m).css("top"));l=f*f+k*k;p<l&&(a.longest=c,p=l)});c.each(function(c,d){var f=parseInt(e(d).css("top")),m=parseInt(e(d).css("left")),g=n[c].x-m,h=n[c].y-f,k=Math.atan2(h,g),l=Math.cos(k)*b.explosionMomentum,k=Math.sin(k)*b.explosionMomentum,g=g/n[c].x,h=h/n[c].y,m=m+l*g,f=f+k*h;e(d).css({top:f,left:m});if(c===a.longest&&(1<=g||1<=h))return clearInterval(a.explodeLoop),
"animate"===b.afterEffect?setTimeout(function(){a.animationEffect()},b.afterAnimationTime):"fade"===b.afterEffect&&a.fadeEffect(),!1})},animationEffect:function(){var a=this;this.elem.children("span").each(function(b,c){b!==a.longest?e(c).animate({top:0,left:0},a.config.callbackAnimationSpeed):a.elem.children("span").eq(a.longest).animate({top:0,left:0},a.config.callbackAnimationSpeed,function(){a.elem.children("span").each(function(a,b){e(b).css({"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)",
"-ms-transform":"rotate(0deg)","-o-transform":"rotate(0deg)",transform:"rotate(0deg)"})});a.exploded=!1})})},fadeEffect:function(){var a=this,b=this.elem.children("span"),c=b.length-1,d=b.eq(c);b.each(function(a,b){if(a!==c)e(b).fadeOut(500);else return!1});d.fadeOut(500,function(){b.each(function(a,b){if(a===c)return!1;l(e(b));e(b).show(500)});l(d);d.show(500,function(){a.exploded=!1})})},preExplode:function(){var a=this,b=this.config;this.loop=setInterval(function(){a.elem.children("span").each(function(c,
f){e(f).css({top:d(-a.shakeRadius,a.shakeRadius,!0),left:d(-a.shakeRadius,a.shakeRadius,!0),"-webkit-transform":"rotate("+d(-b.shakeRotate,b.shakeRotate,!0)+"deg)","-moz-transform":"rotate("+d(-b.shakeRotate,b.shakeRotate,!0)+"deg)","-ms-transform":"rotate("+d(-b.shakeRotate,b.shakeRotate,!0)+"deg)","-o-transform":"rotate("+d(-b.shakeRotate,b.shakeRotate,!0)+"deg)",transform:"rotate("+d(-b.shakeRotate,b.shakeRotate,!0)+"deg)"})})},this.fps);this.growLoop=setInterval(function(){a.shakeRadius+=b.shakeStep;
a.shakeRadius>b.shakeLimit&&a.explode()},b.growSpeed)},cancelExplode:function(){this.exploded||(clearInterval(this.loop),clearInterval(this.growLoop),this.shakeRadius=0,this.elem.children("span").each(function(a,b){l(e(b))}))}};return this.each(function(){var a=e(this),b=q(a.text()),c=new k(a);a.html(b);a.on("mouseenter",function(){c.preExplode()});a.on("mouseleave",function(){c.cancelExplode()})})};var q=function(c){for(var d=0,e=c.length,a="";d<e;d++)a+="<span style='position: relative;'>"+(" "==
c[d]?"&nbsp;":c[d])+"</span>";return a},d=function(c,d,e){return c==p?Math.random():d==p?Math.round(Math.random()*c):e?Math.random()*(d-c)+c:Math.round(Math.random()*(d-c)+c)},l=function(c){c.css({top:0,left:0,"-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)","-o-transform":"rotate(0deg)",transform:"rotate(0deg)"})}})(jQuery);
